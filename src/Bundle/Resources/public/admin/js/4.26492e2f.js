(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[4],{9166:function(e,t,s){"use strict";s.r(t);var i,a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("q-page",[s("div",{staticStyle:{"padding-top":"42px"}},[s("div",{staticClass:"row q-pa-md q-gutter-md"},[s("div",{staticClass:"col col-sm-8 col-md-6 col-lg-4"},[e.user?s("UserForm",{attrs:{user:e.user},on:{"update:user":function(t){e.user=t}}}):e._e()],1)])]),s("q-page-sticky",{attrs:{expand:"",position:"top"}},[s("q-toolbar",{staticClass:"bg-primary text-white"},[e.id?s("q-toolbar-title",[e._v("Editing user "+e._s(e.usernameBackup?e.usernameBackup:e.id))]):s("q-toolbar-title",[e._v("Add new user")])],1)],1)],1)},r=[],n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("form",{staticClass:"q-gutter-md",on:{submit:function(t){return t.preventDefault(),t.stopPropagation(),e.onSubmit(t)}}},[s("q-input",{ref:"username",attrs:{label:"Username",filled:"",readonly:e.user.id>0,hint:"Username can't be changed once user is created",debounce:300,rules:[e.isUsernameValid],"error-message":this.user.username.trim()?"This username is already in use":"Required"},model:{value:e.user.username,callback:function(t){e.$set(e.user,"username",t)},expression:"user.username"}}),s("q-input",{ref:"email",attrs:{label:"Email",filled:"",type:"email",debounce:300,hint:"Make sure email is valid to receive notifications",rules:[e.isEmailValid],"error-message":this.user.email.trim()?"This email is already in use":"Required"},model:{value:e.user.email,callback:function(t){e.$set(e.user,"email",t)},expression:"user.email"}}),e.user.id?e._e():s("q-input",{attrs:{label:"Password",filled:"",hint:e.passwordStrength,rules:[function(e){return!!e||"Required"}],type:e.isPassword?"password":"text"},scopedSlots:e._u([{key:"append",fn:function(){return[s("q-icon",{staticClass:"cursor-pointer",attrs:{name:e.isPassword?"visibility_off":"visibility"},on:{click:function(t){e.isPassword=!e.isPassword}}})]},proxy:!0}],null,!1,1009450914),model:{value:e.user.password,callback:function(t){e.$set(e.user,"password",t)},expression:"user.password"}}),s("q-input",{attrs:{label:"First name",filled:""},model:{value:e.user.firstName,callback:function(t){e.$set(e.user,"firstName",t)},expression:"user.firstName"}}),s("q-input",{attrs:{label:"Last name",filled:""},model:{value:e.user.lastName,callback:function(t){e.$set(e.user,"lastName",t)},expression:"user.lastName"}}),s("q-select",{attrs:{label:"Display name publicly as",filled:"","map-options":"","emit-value":"",options:e.options},model:{value:e.user.displayNameFormat,callback:function(t){e.$set(e.user,"displayNameFormat",t)},expression:"user.displayNameFormat"}}),s("q-select",{attrs:{label:"Roles",filled:"",multiple:"","option-label":"name","option-value":"id",options:e.roles},model:{value:e.user.userRoles,callback:function(t){e.$set(e.user,"userRoles",t)},expression:"user.userRoles"}}),s("q-btn",{attrs:{label:"Save",type:"submit",loading:e.isLoading,color:"primary"}}),e.user.id?s("q-btn",{attrs:{label:"Delete",loading:e.isDeleting,color:"negative"},on:{click:function(t){e.confirmDelete=!0}}}):e._e()],1),s("DeleteUserConfirm",{attrs:{selected:[e.user]},on:{done:e.onDeleteDone,close:function(t){e.confirmDelete=!1}},model:{value:e.confirmDelete,callback:function(t){e.confirmDelete=t},expression:"confirmDelete"}})],1)},o=[],l=s("a4f8"),u=s("8cfb"),c=s("2a3e"),d=s.n(c),m=s("1b40"),p=s("4bb5"),f=function(e,t,s,i){var a,r=arguments.length,n=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,s):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)n=Reflect.decorate(e,t,s,i);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,s,n):a(t,s))||n);return r>3&&n&&Object.defineProperty(t,s,n),n},h=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};const b=Object(p["a"])("User");let y=class extends m["d"]{constructor(){super(...arguments),this.isLoading=!1,this.isDeleting=!1,this.confirmDelete=!1,this.isPassword=!0}created(){this.queryRoles()}onUserChange(){this.initialEmail=this.user.email}get options(){const e=[];return e.push({label:this.user.username,value:"username"}),this.user.firstName&&e.push({label:`${this.user.firstName}`,value:"first_only"}),this.user.lastName&&e.push({label:`${this.user.lastName}`,value:"last_only"}),this.user.firstName&&this.user.lastName&&e.push({label:`${this.user.firstName} ${this.user.lastName}`,value:"first_last"},{label:`${this.user.lastName} ${this.user.firstName}`,value:"last_first"}),e}onSubmit(){this.username.validate(),this.email.validate(),this.username.hasError||this.email.hasError||this.saveUserAction()}async saveUserAction(){var e;this.isLoading=!0;const t=await this.saveUser(this.user);this.isLoading=!1,this.$router.push({name:"user_edit",params:{id:(null!==(e=t.id)&&void 0!==e?e:"").toString()}}).catch((()=>{}))}onDeleteDone(){this.confirmDelete=!1,this.$router.push("/users/").catch((()=>{}))}async isUsernameFreeToUse(){return!!this.user.id||!!this.user.username.trim()&&await this.checkUsernameAvailability(this.user.username)}async isUsernameValid(){return""!==this.user.username.trim()&&await this.isUsernameFreeToUse()}async isEmailFreeToUse(){var e;return this.user.email===this.initialEmail||!!(null===(e=this.user.email)||void 0===e?void 0:e.trim())&&await this.checkEmailAvailability(this.user.email)}async isEmailValid(){var e;return""!==(null===(e=this.user.email)||void 0===e?void 0:e.trim())&&await this.isEmailFreeToUse()}get passwordStrength(){return this.user.password?l(this.user.password).value:""}};f([b.State,h("design:type",Object)],y.prototype,"roles",void 0),f([b.Action,h("design:type",Object)],y.prototype,"queryRoles",void 0),f([b.Action,h("design:type",Object)],y.prototype,"deleteUsers",void 0),f([b.Action,h("design:type",Object)],y.prototype,"saveUser",void 0),f([b.Action,h("design:type",Object)],y.prototype,"checkUsernameAvailability",void 0),f([b.Action,h("design:type",Object)],y.prototype,"checkEmailAvailability",void 0),f([Object(m["b"])(),h("design:type","function"===typeof(i="undefined"!==typeof d.a&&d.a)?i:Object)],y.prototype,"user",void 0),f([Object(m["c"])("username"),h("design:type",Object)],y.prototype,"username",void 0),f([Object(m["c"])("email"),h("design:type",Object)],y.prototype,"email",void 0),f([Object(m["e"])("user.id"),h("design:type",Function),h("design:paramtypes",[]),h("design:returntype",void 0)],y.prototype,"onUserChange",null),y=f([Object(m["a"])({components:{DeleteUserConfirm:u["a"]}})],y);var v=y,g=v,w=s("2877"),j=s("27f9"),U=s("0016"),O=s("ddd8"),N=s("9c40"),k=s("eebe"),q=s.n(k),R=Object(w["a"])(g,n,o,!1,null,null,null),D=R.exports;q()(R,"components",{QInput:j["a"],QIcon:U["a"],QSelect:O["a"],QBtn:N["a"]});var x=function(e,t,s,i){var a,r=arguments.length,n=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,s):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)n=Reflect.decorate(e,t,s,i);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,s,n):a(t,s))||n);return r>3&&n&&Object.defineProperty(t,s,n),n},$=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};const _=Object(p["a"])("User");let E=class extends m["d"]{constructor(){super(...arguments),this.user=this.getNewUser(),this.usernameBackup=""}async created(){this.id&&(this.user=await this.fetchUserById(this.id),this.usernameBackup=this.user.username)}getNewUser(){return new class{constructor(){this.username="",this.firstName="",this.lastName="",this.displayNameFormat="username",this.email="",this.userRoles=[]}}}};x([_.Action,$("design:type",Object)],E.prototype,"fetchUserById",void 0),x([Object(m["b"])(),$("design:type",Number)],E.prototype,"id",void 0),E=x([Object(m["a"])({components:{UserForm:D}})],E);var A=E,P=A,F=s("9989"),S=s("de5e"),C=s("65c6"),T=s("6ac5"),Q=Object(w["a"])(P,a,r,!1,null,null,null);t["default"]=Q.exports;q()(Q,"components",{QPage:F["a"],QPageSticky:S["a"],QToolbar:C["a"],QToolbarTitle:T["a"]})}}]);