(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[11],{"553a":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("q-page",[n("q-toolbar",{staticClass:"bg-grey-3 text-primary q-pl-none q-pr-xs",staticStyle:{"padding-top":"42px"}},[n("q-tabs",{attrs:{"no-caps":"",dense:"",shrink:"",stretch:"",align:"left"},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[n("q-tab",{attrs:{name:"all",label:"All"}}),n("q-tab",{attrs:{name:"published",label:"Published"}}),n("q-tab",{attrs:{name:"trash",label:"Trash"}})],1),n("q-space"),n("q-input",{staticClass:"q-mb-xs",attrs:{dense:"",label:"Filter"},scopedSlots:e._u([{key:"append",fn:function(){return[""===e.filter?n("q-icon",{attrs:{name:"search"}}):n("q-icon",{staticClass:"cursor-pointer",attrs:{name:"clear"},on:{click:function(t){e.filter=""}}})]},proxy:!0}]),model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}})],1),n("q-table",{attrs:{flat:"","binary-state-sort":"",data:e.contentEntitiesOfType,columns:e.columns,"row-key":"id",pagination:e.pagination,loading:e.isLoadingOfType,selection:"multiple",selected:e.selected,"selected-rows-label":e.getSelectedString},on:{"update:pagination":function(t){e.pagination=t},request:e.onRequest,"update:selected":function(t){e.selected=t}},scopedSlots:e._u([{key:"body-cell",fn:function(t){return[n("q-td",[e._v("\n                "+e._s(t.value)+"\n            ")])]}},{key:"body-cell-title",fn:function(t){return[n("q-td",{attrs:{props:t},nativeOn:{mouseover:function(n){e.showDetails=t.row.id},mouseleave:function(t){e.showDetails=null}}},[e.type?n("router-link",{staticClass:"text-weight-medium",attrs:{to:{name:e.type+"_edit",params:{id:t.row.id}}}},[e._v(e._s(t.value))]):e._e()],1)]}},{key:"body-cell-actions",fn:function(t){return[n("q-td",[n("q-btn-group",{attrs:{flat:""}},[e.type&&"trash"!==e.tab?n("q-btn",{attrs:{flat:"",dense:"",color:"primary",icon:"mdi-file-document-edit-outline",to:{name:e.type+"_edit_classic",params:{id:t.row.id}}}},[n("q-tooltip",[e._v("Classic editor")])],1):e._e(),"trash"===e.tab?n("q-btn",{attrs:{flat:"",dense:"",color:"primary",icon:"mdi-backup-restore"},on:{click:function(n){return e.restore([t.row])}}},[n("q-tooltip",[e._v("Restore")])],1):e._e(),n("q-btn",{attrs:{flat:"",dense:"",color:"negative",icon:"mdi-delete-outline"},on:{click:function(n){return e.singleDelete(t.row)}}},[n("q-tooltip",[e._v("Delete"+e._s("trash"===e.tab?" permanently":""))])],1),"trash"!==e.tab?n("q-btn",{attrs:{flat:"",dense:"",color:"secondary",icon:"mdi-eye-outline",href:t.row.publicUrl,type:"a",target:"_blank"}},[n("q-tooltip",[e._v("View")])],1):e._e()],1)],1)]}},{key:"body-cell-username",fn:function(t){return[n("q-td",[t.row.author?n("router-link",{attrs:{to:{name:"user_edit",params:{id:t.row.author.id}}}},[e._v(e._s(t.value))]):n("span",[e._v("—")])],1)]}},{key:"body-cell-categories",fn:function(t){return[n("q-td",e._l(t.value,(function(t){return n("router-link",{key:t.id,attrs:{to:{name:"term_edit",params:{id:t.id,taxonomy:"category"}}}},[e._v(e._s(t.name))])})),1)]}},{key:"body-cell-tags",fn:function(t){return[n("q-td",{staticClass:"q-gutter-x-xs"},e._l(t.value,(function(t){return n("router-link",{key:t.id,attrs:{to:{name:"term_edit",params:{id:t.id,taxonomy:"tag"}}}},[e._v(e._s(t.name))])})),1)]}},{key:"pagination",fn:function(t){return[n("div",{staticClass:"q-px-md"},[e._v("\n                "+e._s(1+(t.pagination.page-1)*t.pagination.rowsPerPage)+"-"+e._s(Math.min(t.pagination.page*t.pagination.rowsPerPage,e.contentEntitiesCountOfType))+" of "+e._s(e.contentEntitiesCountOfType)+"\n            ")]),t.pagesNumber>2?n("q-btn",{attrs:{icon:"first_page",color:"grey-8",round:"",dense:"",flat:"",disable:t.isFirstPage},on:{click:t.firstPage}}):e._e(),n("q-btn",{attrs:{icon:"chevron_left",color:"grey-8",round:"",dense:"",flat:"",disable:t.isFirstPage},on:{click:t.prevPage}}),n("q-pagination",{attrs:{color:"grey-8",max:t.pagesNumber,size:"sm"},on:{input:e.fetch},model:{value:e.pagination.page,callback:function(t){e.$set(e.pagination,"page",t)},expression:"pagination.page"}}),n("q-btn",{attrs:{icon:"chevron_right",color:"grey-8",round:"",dense:"",flat:"",disable:t.isLastPage},on:{click:t.nextPage}}),t.pagesNumber>2?n("q-btn",{attrs:{icon:"last_page",color:"grey-8",round:"",dense:"",flat:"",disable:t.isLastPage},on:{click:t.lastPage}}):e._e()]}}])}),n("div",{staticClass:"q-pa-md q-gutter-md"},["trash"===e.tab?n("q-btn",{attrs:{color:"negative",label:"Empty trash"},on:{click:e.emptyTrash}}):e._e(),e.selected.length>0?n("q-btn",{attrs:{color:"negative",label:"Delete"},on:{click:function(t){e.confirmDelete=!0}}}):e._e(),e.selected.length>0&&"trash"===e.tab?n("q-btn",{attrs:{color:"primary",loading:e.restoreLoading,label:"Restore"},on:{click:function(t){return e.restore(e.selected)}}}):e._e()],1),n("q-dialog",{model:{value:e.confirmDelete,callback:function(t){e.confirmDelete=t},expression:"confirmDelete"}},[n("q-card",[n("q-card-section",{staticClass:"row items-center"},[n("q-avatar",{attrs:{icon:"trash"===e.tab?"delete_forever":"delete",color:"negative","text-color":"white"}}),1===e.selected.length?n("span",{staticClass:"q-ml-sm"},[e._v("Do you want to"+e._s("trash"===e.tab?" permanently":"")+" delete this "+e._s(e.contentType.labels.singularName)+"?")]):e._e(),e.selected.length>1?n("span",{staticClass:"q-ml-sm"},[e._v("Do you want to"+e._s("trash"===e.tab?" permanently":"")+" delete these "+e._s(e.contentType.labels.pluralName)+"?")]):e._e(),0===e.selected.length?n("span",{staticClass:"q-ml-sm"},[e._v("Do you want to permanently delete all "+e._s(e.contentType.labels.pluralName)+"?")]):e._e()],1),n("q-card-actions",{attrs:{align:"right"}},[n("q-btn",{attrs:{flat:"",label:"No",color:"secondary"},on:{click:function(t){e.confirmDelete=!1}}}),n("q-btn",{attrs:{flat:"",loading:e.deleteLoading,label:"Yes",color:"primary",autofocus:""},on:{click:e.confirmDeleteAction,keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.confirmDeleteAction(t)}}})],1)],1)],1),n("q-page-sticky",{attrs:{expand:"",position:"top"}},[n("q-toolbar",{staticClass:"bg-primary text-white"},[e.contentType?n("q-toolbar-title",[e._v("\n                "+e._s(e.contentType.labels.menuName)+"\n            ")]):e._e()],1)],1)],1)},i=[],s=n("60a3"),o=n("7905"),r=n("b9b9"),l=n.n(r),c=n("4bb5"),d=n("2ef0"),p=function(e,t,n,a){var i,s=arguments.length,o=s<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,a);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(o=(s<3?i(o):s>3?i(t,n,o):i(t,n))||o);return s>3&&o&&Object.defineProperty(t,n,o),o},u=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};const g=Object(c["a"])("ContentType"),f=Object(c["a"])("Content");let y=class extends s["d"]{constructor(){super(...arguments),this.tab="all",this.filter="",this.showDetails=null,this.pagination={sortBy:"createdAt",descending:!0,page:1,rowsPerPage:10,rowsNumber:this.contentEntitiesCountOfType},this.columns=[{name:"title",required:!0,label:"Title",align:"left",field:"title",sortable:!0},{name:"actions",required:!0,label:"",align:"left",field:null},{name:"username",required:!0,label:"Author",align:"left",field:e=>{var t,n;return null!==(n=null===(t=e.author)||void 0===t?void 0:t.username)&&void 0!==n?n:"—"},sortable:!0},{name:"categories",label:"Categories",align:"left",field:e=>this.getTaxonomyTerms(e,"category")},{name:"tags",label:"Tags",align:"left",field:e=>this.getTaxonomyTerms(e,"tag")},{name:"comments",label:"Comments",align:"left",field:"comments"},{name:"createdAt",label:"Date",align:"left",field:"createdAt",format:e=>l()(e,"yyyy/mm/dd"),sortable:!0}],this.selected=[],this.confirmDelete=!1,this.deleteLoading=!1,this.restoreLoading=!1}created(){o["a"].on("ContentType:loaded",(()=>this.fetch())),this.contentType&&this.fetch()}fetch(){this.contentType&&this.onRequest({pagination:this.pagination,filter:this.filter})}onTabChanged(){this.selected=[],this.fetch()}async onRequest(e){const{page:t,rowsPerPage:n,sortBy:a,descending:i}=e.pagination,s=0===n?"":n,o=(t-1)*n,r=this.filter;await this.fetchPage({type:this.contentType,startRow:o,fetchCount:s,filter:r,sortBy:a,descending:i,status:this.contentStatus}),this.pagination.page=t,this.pagination.rowsPerPage=n,this.pagination.sortBy=a,this.pagination.descending=i,this.pagination.rowsNumber=this.contentEntitiesCountOfType}get contentType(){return this.contentTypes.find((e=>e.name===this.type))}get contentEntitiesOfType(){return Object(d["get"])(this.contentEntities,this.type,[])}get contentEntitiesCountOfType(){return Object(d["get"])(this.contentEntitiesCount,this.type,0)}get isLoadingOfType(){return Object(d["get"])(this.isLoading,this.type,!1)}get contentStatus(){switch(this.tab){case"published":return"publish";case"trash":return"deleted";default:return"publish,private,draft"}}getSelectedString(){return 0===this.selected.length?"":`${this.selected.length} ${this.selected.length>1?this.contentType.labels.pluralName:this.contentType.labels.singularName} selected of ${this.contentEntitiesOfType.length}`}async confirmDeleteAction(){this.deleteLoading=!0,await this.deleteEntities({type:this.contentType,entities:this.selected}),this.confirmDelete=!1,this.deleteLoading=!1,this.selected=[],this.fetch()}async singleDelete(e){await this.deleteEntities({type:this.contentType,entities:[e]}),this.selected.find((t=>t.id===e.id))&&this.selected.splice(this.selected.findIndex((t=>t.id===e.id)),1),this.fetch()}emptyTrash(){this.selected=[],this.confirmDelete=!0}async restore(e){this.restoreLoading=!0,await this.restoreEntities({type:this.contentType,entities:e}),this.restoreLoading=!1,e.forEach((e=>{this.selected.find((t=>t.id===e.id))&&this.selected.splice(this.selected.findIndex((t=>t.id===e.id)),1)})),this.fetch()}getTaxonomyTerms(e,t){return e.terms.filter((e=>e.taxonomy.name===t))}};p([g.State,u("design:type",Object)],y.prototype,"contentTypes",void 0),p([f.State,u("design:type",Object)],y.prototype,"contentEntities",void 0),p([f.State,u("design:type",Object)],y.prototype,"contentEntitiesCount",void 0),p([f.State,u("design:type",Object)],y.prototype,"isLoading",void 0),p([f.Action,u("design:type",Object)],y.prototype,"fetchPage",void 0),p([f.Action,u("design:type",Object)],y.prototype,"deleteEntities",void 0),p([f.Action,u("design:type",Object)],y.prototype,"restoreEntities",void 0),p([Object(s["b"])(),u("design:type",String)],y.prototype,"type",void 0),p([Object(s["e"])("filter"),u("design:type",Function),u("design:paramtypes",[]),u("design:returntype",void 0)],y.prototype,"fetch",null),p([Object(s["e"])("tab"),u("design:type",Function),u("design:paramtypes",[]),u("design:returntype",void 0)],y.prototype,"onTabChanged",null),y=p([s["a"]],y);var h=y,b=h,m=n("2877"),_=n("9989"),q=n("65c6"),v=n("429b"),T=n("7460"),k=n("2c91"),w=n("27f9"),C=n("0016"),O=n("eaac"),x=n("db86"),P=n("e7a9"),D=n("9c40"),E=n("05c0"),j=n("3b16"),Q=n("24e8"),S=n("f09f"),L=n("a370"),A=n("cb32"),N=n("4b7e"),R=n("de5e"),B=n("6ac5"),F=n("eebe"),$=n.n(F),I=Object(m["a"])(b,a,i,!1,null,null,null);t["default"]=I.exports;$()(I,"components",{QPage:_["a"],QToolbar:q["a"],QTabs:v["a"],QTab:T["a"],QSpace:k["a"],QInput:w["a"],QIcon:C["a"],QTable:O["a"],QTd:x["a"],QBtnGroup:P["a"],QBtn:D["a"],QTooltip:E["a"],QPagination:j["a"],QDialog:Q["a"],QCard:S["a"],QCardSection:L["a"],QAvatar:A["a"],QCardActions:N["a"],QPageSticky:R["a"],QToolbarTitle:B["a"]})}}]);