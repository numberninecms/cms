(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[17],{"3ecf":function(e,t,i){"use strict";i.r(t);var o=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("q-page",[i("div",{staticClass:"row"},[e.rolesCopy?i("div",{staticClass:"q-ma-md q-col-gutter-md col",staticStyle:{"padding-top":"42px"}},[i("div",{staticClass:"row"},[i("div",{staticClass:"col col-sm-8 col-md-6 col-lg-4"},[i("q-input",{attrs:{label:"Add new role",filled:""},scopedSlots:e._u([{key:"after",fn:function(){return[i("q-btn",{staticClass:"full-height",attrs:{color:"primary",icon:"add"},on:{click:e.addRole}})]},proxy:!0}],null,!1,3825024792),model:{value:e.newRole.name,callback:function(t){e.$set(e.newRole,"name",t)},expression:"newRole.name"}})],1)]),i("div",{staticClass:"col"},[i("q-markup-table",{attrs:{flat:""}},[i("thead",[i("tr",[i("th"),e._l(e.rolesCopy,(function(t){return i("th",{key:t.name,staticClass:"text-center"},[e._v("\n                                "+e._s(t.name)+"\n                                "),e.isBuiltInRole(t)?e._e():i("q-btn",{attrs:{dense:"",flat:"",icon:"delete_forever",color:"negative",loading:e.deleteLoading[t.name]},on:{click:function(i){return e.deleteUserRole(t)}}})],1)}))],2)]),i("tbody",e._l(e.capabilities,(function(t){return i("tr",{key:t},[i("td",[e._v(e._s(t))]),e._l(e.rolesCopy,(function(o){return i("td",{key:o.name,staticClass:"text-center"},[i("q-checkbox",{attrs:{value:e.hasCapability(o,t)},on:{input:function(i){return e.updateRoleCapability(o,t,i)}}})],1)}))],2)})),0)])],1),i("div",[i("q-btn",{staticClass:"q-mt-lg",attrs:{label:"Save roles",color:"primary",loading:e.saveLoading},on:{click:function(t){return e.saveUserRoles()}}})],1)]):e._e()]),i("q-page-sticky",{attrs:{expand:"",position:"top"}},[i("q-toolbar",{staticClass:"bg-primary text-white"},[i("q-toolbar-title",[e._v("\n                Roles\n            ")])],1)],1)],1)},a=[],s=i("2ef0"),l=i("1b40"),n=i("4bb5"),r=function(e,t,i,o){var a,s=arguments.length,l=s<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)l=Reflect.decorate(e,t,i,o);else for(var n=e.length-1;n>=0;n--)(a=e[n])&&(l=(s<3?a(l):s>3?a(t,i,l):a(t,i))||l);return s>3&&l&&Object.defineProperty(t,i,l),l},c=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};const p=Object(n["a"])("User");let d=class extends l["d"]{constructor(){super(...arguments),this.rolesCopy=[],this.newRole=this.getNewRole(),this.deleteLoading={},this.saveLoading=!1}async created(){await Promise.all([this.queryRoles(),this.queryCapabilities()]),this.rolesCopy.splice(0,this.rolesCopy.length,...Object(s["cloneDeep"])(this.roles))}getNewRole(){return new class{constructor(){this.name="",this.capabilities=[]}}}addRole(){this.newRole.name.trim()&&(this.rolesCopy.push(Object(s["cloneDeep"])(this.newRole)),this.newRole=this.getNewRole())}hasCapability(e,t){return e.capabilities.includes(t)}updateRoleCapability(e,t,i){i&&!this.hasCapability(e,t)?e.capabilities.push(t):i||e.capabilities.splice(e.capabilities.indexOf(t),1)}isBuiltInRole(e){return["Subscriber","Contributor","Author","Editor","Administrator"].includes(e.name)}async deleteUserRole(e){const t=Object(s["cloneDeep"])(e);this.deleteLoading[t.name]=!0,t.id&&await this.deleteRole(t),this.rolesCopy.splice(this.rolesCopy.findIndex((e=>e.name===t.name)),1),this.deleteLoading[t.name]=!1}async saveUserRoles(){this.saveLoading=!0,await this.saveRoles(this.rolesCopy),this.saveLoading=!1}};r([p.State,c("design:type",Object)],d.prototype,"roles",void 0),r([p.State,c("design:type",Object)],d.prototype,"capabilities",void 0),r([p.Action,c("design:type",Object)],d.prototype,"queryRoles",void 0),r([p.Action,c("design:type",Object)],d.prototype,"queryCapabilities",void 0),r([p.Action,c("design:type",Object)],d.prototype,"saveRoles",void 0),r([p.Action,c("design:type",Object)],d.prototype,"deleteRole",void 0),d=r([l["a"]],d);var u=d,b=u,y=i("2877"),h=i("9989"),f=i("27f9"),g=i("9c40"),v=i("2bb1"),R=i("8f8e"),m=i("de5e"),C=i("65c6"),w=i("6ac5"),q=i("eebe"),k=i.n(q),j=Object(y["a"])(b,o,a,!1,null,null,null);t["default"]=j.exports;k()(j,"components",{QPage:h["a"],QInput:f["a"],QBtn:g["a"],QMarkupTable:v["a"],QCheckbox:R["a"],QPageSticky:m["a"],QToolbar:C["a"],QToolbarTitle:w["a"]})}}]);