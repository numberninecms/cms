(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[2],{"252f":function(e,t){},ee93:function(e,t,n){"use strict";n.r(t);var o,i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("q-page",[n("div",{staticStyle:{"padding-top":"42px"}},[n("div",{staticClass:"row q-pa-md q-gutter-md"},[n("div",{staticClass:"col-4"},[e.isNew?n("h2",{staticClass:"text-h6 q-pb-md"},[e._v("Add a new "+e._s(e.taxonomy))]):e._e(),e.isNew?e._e():n("h2",{staticClass:"text-h6 q-pb-md"},[e._v("Edit a "+e._s(e.taxonomy))]),n("TermForm",{attrs:{taxonomy:e.taxonomy,term:e.term},on:{"update:term":function(t){e.term=t},save:e.onSave,delete:e.onDelete,new:e.newTerm}})],1),n("div",{staticClass:"col"},[n("q-table",{attrs:{flat:"","binary-state-sort":"",data:e.termsOfTaxonomy,columns:e.columns,"row-key":"id",pagination:e.pagination,loading:e.isLoadingOfTaxonomy,selection:"multiple",selected:e.selected,"selected-rows-label":e.getSelectedString},on:{"update:pagination":function(t){e.pagination=t},request:e.onRequest,"update:selected":function(t){e.selected=t}},scopedSlots:e._u([{key:"body-cell-name",fn:function(t){return[n("q-td",{attrs:{props:t}},[n("div",{staticClass:"cursor-pointer text-primary text-weight-medium",on:{click:function(n){return e.editTerm(t.row)}}},[e._v(e._s(t.value))])])]}},{key:"pagination",fn:function(t){return[n("div",{staticClass:"q-px-md"},[e._v("\n                            "+e._s(1+(t.pagination.page-1)*t.pagination.rowsPerPage)+"-"+e._s(Math.min(t.pagination.page*t.pagination.rowsPerPage,e.termsCountOfTaxonomy))+" of "+e._s(e.termsCountOfTaxonomy)+"\n                        ")]),t.pagesNumber>2?n("q-btn",{attrs:{icon:"first_page",color:"grey-8",round:"",dense:"",flat:"",disable:t.isFirstPage},on:{click:t.firstPage}}):e._e(),n("q-btn",{attrs:{icon:"chevron_left",color:"grey-8",round:"",dense:"",flat:"",disable:t.isFirstPage},on:{click:t.prevPage}}),n("q-pagination",{attrs:{color:"grey-8",max:t.pagesNumber,size:"sm"},on:{input:e.fetch},model:{value:e.pagination.page,callback:function(t){e.$set(e.pagination,"page",t)},expression:"pagination.page"}}),n("q-btn",{attrs:{icon:"chevron_right",color:"grey-8",round:"",dense:"",flat:"",disable:t.isLastPage},on:{click:t.nextPage}}),t.pagesNumber>2?n("q-btn",{attrs:{icon:"last_page",color:"grey-8",round:"",dense:"",flat:"",disable:t.isLastPage},on:{click:t.lastPage}}):e._e()]}}])}),e.selected.length>0?n("q-btn",{attrs:{color:"negative",label:"Delete"},on:{click:function(t){e.confirmDelete=!0}}}):e._e()],1)])]),n("q-dialog",{model:{value:e.confirmDelete,callback:function(t){e.confirmDelete=t},expression:"confirmDelete"}},[n("q-card",[n("q-card-section",{staticClass:"row items-center"},[n("q-avatar",{attrs:{icon:"delete_forever",color:"negative","text-color":"white"}}),1===e.selected.length?n("span",{staticClass:"q-ml-sm"},[e._v("Do you want to permanently delete this "+e._s(e.taxonomy)+"?")]):e._e(),e.selected.length>1?n("span",{staticClass:"q-ml-sm"},[e._v("Do you want to permanently delete these "+e._s(e.pluralTaxonomy)+"?")]):e._e()],1),n("q-card-actions",{attrs:{align:"right"}},[n("q-btn",{attrs:{flat:"",label:"No",color:"secondary"},on:{click:function(t){e.confirmDelete=!1}}}),n("q-btn",{attrs:{flat:"",loading:e.deleteLoading,label:"Yes",color:"primary",autofocus:""},on:{click:e.confirmDeleteAction,keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.confirmDeleteAction(t)}}})],1)],1)],1),n("q-page-sticky",{attrs:{expand:"",position:"top"}},[n("q-toolbar",{staticClass:"bg-primary text-white"},[n("q-toolbar-title",[e._v("\n                "+e._s(e.formattedTaxonomy)+"\n            ")])],1)],1)],1)},a=[],s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form",{staticClass:"q-gutter-md",on:{submit:function(t){return t.preventDefault(),t.stopPropagation(),e.onSubmit(t)}}},[n("q-input",{ref:"name",attrs:{filled:"",rules:[function(e){return!!e||"* Required"}],"lazy-rules":"ondemand",label:"Name"},on:{input:e.slugify},model:{value:e.term.name,callback:function(t){e.$set(e.term,"name",t)},expression:"term.name"}}),n("q-input",{ref:"slug",attrs:{filled:"",rules:[function(e){return!!e||"* Required"}],"lazy-rules":"ondemand",label:"Slug"},model:{value:e.term.slug,callback:function(t){e.$set(e.term,"slug",t)},expression:"term.slug"}}),n("q-input",{attrs:{filled:"",autogrow:"",label:"Description"},model:{value:e.term.description,callback:function(t){e.$set(e.term,"description",t)},expression:"term.description"}}),n("q-btn",{attrs:{label:"Save",type:"submit",loading:e.isLoading,color:"primary"}}),e.term.id?n("q-btn",{attrs:{label:"Delete",loading:e.isDeleting,color:"negative"},on:{click:e.deleteTaxonomyTerm}}):e._e(),n("q-btn",{attrs:{label:"New"},on:{click:function(t){return e.$emit("new")}}})],1)},r=[],l=n("252f"),c=n.n(l),d=n("1b40"),m=n("4bb5"),p=n("ff94"),g=function(e,t,n,o){var i,a=arguments.length,s=a<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(s=(a<3?i(s):a>3?i(t,n,s):i(t,n))||s);return a>3&&s&&Object.defineProperty(t,n,s),s},u=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};const f=Object(m["a"])("Taxonomy");let y=class extends d["d"]{constructor(){super(...arguments),this.isLoading=!1,this.isDeleting=!1}async saveTaxonomyTerm(){this.isLoading=!0;const e=await this.saveTerm({taxonomy:this.taxonomy,term:this.term});this.isLoading=!1,this.$emit("save",e)}async deleteTaxonomyTerm(){this.isDeleting=!0,await this.deleteTerms({taxonomy:this.taxonomy,terms:[this.term]}),this.isDeleting=!1,this.$emit("delete")}slugify(){this.term.slug=p["a"](this.term.name)}onSubmit(){this.name.validate(),this.slug.validate(),this.name.hasError||this.slug.hasError||this.saveTaxonomyTerm()}};g([f.Action,u("design:type",Object)],y.prototype,"saveTerm",void 0),g([f.Action,u("design:type",Object)],y.prototype,"deleteTerms",void 0),g([Object(d["c"])("name"),u("design:type",Object)],y.prototype,"name",void 0),g([Object(d["c"])("slug"),u("design:type",Object)],y.prototype,"slug",void 0),g([Object(d["b"])(),u("design:type","function"===typeof(o="undefined"!==typeof c.a&&c.a)?o:Object)],y.prototype,"term",void 0),g([Object(d["b"])(),u("design:type",String)],y.prototype,"taxonomy",void 0),y=g([d["a"]],y);var h=y,b=h,x=n("2877"),v=n("27f9"),T=n("9c40"),w=n("eebe"),O=n.n(w),q=Object(x["a"])(b,s,r,!1,null,null,null),j=q.exports;O()(q,"components",{QInput:v["a"],QBtn:T["a"]});var _=n("2ef0"),P=n("3043"),D=n("761a"),k=n.n(D),C=function(e,t,n,o){var i,a=arguments.length,s=a<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(s=(a<3?i(s):a>3?i(t,n,s):i(t,n))||s);return a>3&&s&&Object.defineProperty(t,n,s),s},S=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};const R=Object(m["a"])("Taxonomy");let N=class extends d["d"]{constructor(){super(...arguments),this.term=this.getNewTerm(),this.pagination={sortBy:"name",descending:!0,page:1,rowsPerPage:10,rowsNumber:this.termsCountOfTaxonomy},this.columns=[{name:"name",required:!0,label:"Name",align:"left",field:"name",sortable:!0},{name:"slug",required:!0,label:"Slug",align:"left",field:"slug",sortable:!0},{name:"description",required:!0,label:"Description",align:"left",field:"description",sortable:!1}],this.filter="",this.selected=[],this.confirmDelete=!1,this.deleteLoading=!1}async created(){if(await this.fetch(),this.id){let e=this.termsOfTaxonomy.find((e=>e.id===parseInt(this.id)));e||(e=await this.fetchTermById({taxonomy:this.taxonomy,id:this.id})),e&&(this.term=Object(_["cloneDeep"])(e))}}async fetch(){await this.onRequest({pagination:this.pagination,filter:this.filter})}async onRequest(e){const{page:t,rowsPerPage:n,sortBy:o,descending:i}=e.pagination,a=0===n?"":n,s=(t-1)*n,r=this.filter;await this.fetchTermPage({taxonomy:this.taxonomy,startRow:s,fetchCount:a,filter:r,sortBy:o,descending:i}),this.pagination.page=t,this.pagination.rowsPerPage=n,this.pagination.sortBy=o,this.pagination.descending=i,this.pagination.rowsNumber=this.termsCountOfTaxonomy}getSelectedString(){return 0===this.selected.length?"":`${this.selected.length} ${this.selected.length>1?k()(this.taxonomy):this.taxonomy} selected of ${this.termsOfTaxonomy.length}`}getNewTerm(){return new class{}}reset(){this.term=this.getNewTerm()}onSave(e){this.term=Object(_["cloneDeep"])(e),this.fetch()}onDelete(){this.reset(),this.fetch()}async confirmDeleteAction(){this.deleteLoading=!0,await this.deleteTerms({taxonomy:this.taxonomy,terms:this.selected}),this.confirmDelete=!1,this.deleteLoading=!1,this.selected=[],await this.fetch()}editTerm(e){parseInt(this.id)!==e.id&&this.$router.push({name:"term_edit",params:{taxonomy:this.taxonomy,id:e.id.toString()}})}newTerm(){this.id&&(this.reset(),this.$router.push({name:"taxonomy_index",params:{taxonomy:this.taxonomy}}))}get termsOfTaxonomy(){return Object(_["get"])(this.terms,this.taxonomy,[])}get termsCountOfTaxonomy(){return Object(_["get"])(this.termsCount,this.taxonomy,0)}get isLoadingOfTaxonomy(){return Object(_["get"])(this.isLoading,this.taxonomy,!1)}get formattedTaxonomy(){return P["a"](this.pluralTaxonomy)}get pluralTaxonomy(){return k()(this.taxonomy)}get isNew(){var e;return!(null===(e=this.term)||void 0===e?void 0:e.id)}};C([R.State,S("design:type",Object)],N.prototype,"terms",void 0),C([R.State,S("design:type",Object)],N.prototype,"termsCount",void 0),C([R.State,S("design:type",Object)],N.prototype,"pagesCount",void 0),C([R.State,S("design:type",Object)],N.prototype,"isLoading",void 0),C([R.Action,S("design:type",Object)],N.prototype,"fetchTaxonomies",void 0),C([R.Action,S("design:type",Object)],N.prototype,"fetchTermById",void 0),C([R.Action,S("design:type",Object)],N.prototype,"fetchTermPage",void 0),C([R.Action,S("design:type",Object)],N.prototype,"deleteTerms",void 0),C([Object(d["b"])(),S("design:type",String)],N.prototype,"taxonomy",void 0),C([Object(d["b"])(),S("design:type",String)],N.prototype,"id",void 0),C([Object(d["e"])("filter"),S("design:type",Function),S("design:paramtypes",[]),S("design:returntype",Promise)],N.prototype,"fetch",null),N=C([Object(d["a"])({components:{TermForm:j}})],N);var Q=N,L=Q,$=n("9989"),A=n("eaac"),B=n("db86"),E=n("3b16"),F=n("24e8"),I=n("f09f"),z=n("a370"),J=n("cb32"),M=n("4b7e"),Y=n("de5e"),G=n("65c6"),H=n("6ac5"),K=Object(x["a"])(L,i,a,!1,null,null,null);t["default"]=K.exports;O()(K,"components",{QPage:$["a"],QTable:A["a"],QTd:B["a"],QBtn:T["a"],QPagination:E["a"],QDialog:F["a"],QCard:I["a"],QCardSection:z["a"],QAvatar:J["a"],QCardActions:M["a"],QPageSticky:Y["a"],QToolbar:G["a"],QToolbarTitle:H["a"]})}}]);