(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[3],{ee93:function(e,t,n){"use strict";n.r(t);var o,i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("q-page",[n("div",{staticStyle:{"padding-top":"42px"}},[n("div",{staticClass:"row q-pa-md q-gutter-md"},[n("div",{staticClass:"col-4"},[e.isNew?n("h2",{staticClass:"text-h6 q-pb-md"},[e._v("Add a new "+e._s(e.taxonomy))]):e._e(),e.isNew?e._e():n("h2",{staticClass:"text-h6 q-pb-md"},[e._v("Edit a "+e._s(e.taxonomy))]),n("TermForm",{attrs:{taxonomy:e.taxonomy,term:e.term},on:{"update:term":function(t){e.term=t},save:e.onSave,delete:e.onDelete,new:e.newTerm}})],1),n("div",{staticClass:"col"},[n("q-table",{attrs:{flat:"","binary-state-sort":"",data:e.termsOfTaxonomy,columns:e.columns,"row-key":"id",pagination:e.pagination,loading:e.isLoadingOfTaxonomy,selection:"multiple",selected:e.selected,"selected-rows-label":e.getSelectedString},on:{"update:pagination":function(t){e.pagination=t},request:e.onRequest,"update:selected":function(t){e.selected=t}},scopedSlots:e._u([{key:"body-cell-name",fn:function(t){return[n("q-td",{attrs:{props:t}},[n("div",{staticClass:"cursor-pointer text-primary text-weight-medium",on:{click:function(n){return e.editTerm(t.row)}}},[e._v(e._s(t.value))])])]}},{key:"pagination",fn:function(t){return[n("div",{staticClass:"q-px-md"},[e._v("\n                            "+e._s(1+(t.pagination.page-1)*t.pagination.rowsPerPage)+"-"+e._s(Math.min(t.pagination.page*t.pagination.rowsPerPage,e.termsCountOfTaxonomy))+" of "+e._s(e.termsCountOfTaxonomy)+"\n                        ")]),t.pagesNumber>2?n("q-btn",{attrs:{icon:"first_page",color:"grey-8",round:"",dense:"",flat:"",disable:t.isFirstPage},on:{click:t.firstPage}}):e._e(),n("q-btn",{attrs:{icon:"chevron_left",color:"grey-8",round:"",dense:"",flat:"",disable:t.isFirstPage},on:{click:t.prevPage}}),n("q-pagination",{attrs:{color:"grey-8",max:t.pagesNumber,size:"sm"},on:{input:e.fetch},model:{value:e.pagination.page,callback:function(t){e.$set(e.pagination,"page",t)},expression:"pagination.page"}}),n("q-btn",{attrs:{icon:"chevron_right",color:"grey-8",round:"",dense:"",flat:"",disable:t.isLastPage},on:{click:t.nextPage}}),t.pagesNumber>2?n("q-btn",{attrs:{icon:"last_page",color:"grey-8",round:"",dense:"",flat:"",disable:t.isLastPage},on:{click:t.lastPage}}):e._e()]}}])}),e.selected.length>0?n("q-btn",{attrs:{color:"negative",label:"Delete"},on:{click:function(t){e.confirmDelete=!0}}}):e._e()],1)])]),n("q-dialog",{model:{value:e.confirmDelete,callback:function(t){e.confirmDelete=t},expression:"confirmDelete"}},[n("q-card",[n("q-card-section",{staticClass:"row items-center"},[n("q-avatar",{attrs:{icon:"delete_forever",color:"negative","text-color":"white"}}),1===e.selected.length?n("span",{staticClass:"q-ml-sm"},[e._v("Do you want to permanently delete this "+e._s(e.taxonomy)+"?")]):e._e(),e.selected.length>1?n("span",{staticClass:"q-ml-sm"},[e._v("Do you want to permanently delete these "+e._s(e.pluralTaxonomy)+"?")]):e._e()],1),n("q-card-actions",{attrs:{align:"right"}},[n("q-btn",{attrs:{flat:"",label:"No",color:"secondary"},on:{click:function(t){e.confirmDelete=!1}}}),n("q-btn",{attrs:{flat:"",loading:e.deleteLoading,label:"Yes",color:"primary",autofocus:""},on:{click:e.confirmDeleteAction,keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.confirmDeleteAction(t)}}})],1)],1)],1),n("q-page-sticky",{attrs:{expand:"",position:"top"}},[n("q-toolbar",{staticClass:"bg-primary text-white"},[n("q-toolbar-title",[e._v("\n                "+e._s(e.formattedTaxonomy)+"\n            ")])],1)],1)],1)},a=[],s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form",{staticClass:"q-gutter-md",on:{submit:function(t){return t.preventDefault(),t.stopPropagation(),e.onSubmit(t)}}},[n("q-input",{ref:"name",attrs:{filled:"",rules:[function(e){return!!e||"* Required"}],"lazy-rules":"ondemand",label:"Name"},on:{input:e.slugify},model:{value:e.term.name,callback:function(t){e.$set(e.term,"name",t)},expression:"term.name"}}),n("q-input",{ref:"slug",attrs:{filled:"",rules:[function(e){return!!e||"* Required"}],"lazy-rules":"ondemand",label:"Slug"},model:{value:e.term.slug,callback:function(t){e.$set(e.term,"slug",t)},expression:"term.slug"}}),n("q-input",{attrs:{filled:"",autogrow:"",label:"Description"},model:{value:e.term.description,callback:function(t){e.$set(e.term,"description",t)},expression:"term.description"}}),n("q-btn",{attrs:{label:"Save",type:"submit",loading:e.isLoading,color:"primary"}}),e.term.id?n("q-btn",{attrs:{label:"Delete",loading:e.isDeleting,color:"negative"},on:{click:e.deleteTaxonomyTerm}}):e._e(),n("q-btn",{attrs:{label:"New"},on:{click:function(t){return e.$emit("new")}}})],1)},r=[],l=n("1b40"),c=n("4bb5"),d=n("ff94"),m=function(e,t,n,o){var i,a=arguments.length,s=a<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(s=(a<3?i(s):a>3?i(t,n,s):i(t,n))||s);return a>3&&s&&Object.defineProperty(t,n,s),s},p=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};const g=Object(c["a"])("Taxonomy");let u=class extends l["d"]{constructor(){super(...arguments),this.isLoading=!1,this.isDeleting=!1}async saveTaxonomyTerm(){this.isLoading=!0;const e=await this.saveTerm({taxonomy:this.taxonomy,term:this.term});this.isLoading=!1,this.$emit("save",e)}async deleteTaxonomyTerm(){this.isDeleting=!0,await this.deleteTerms({taxonomy:this.taxonomy,terms:[this.term]}),this.isDeleting=!1,this.$emit("delete")}slugify(){this.term.slug=d["a"](this.term.name)}onSubmit(){this.name.validate(),this.slug.validate(),this.name.hasError||this.slug.hasError||this.saveTaxonomyTerm()}};m([g.Action,p("design:type",Object)],u.prototype,"saveTerm",void 0),m([g.Action,p("design:type",Object)],u.prototype,"deleteTerms",void 0),m([Object(l["c"])("name"),p("design:type",Object)],u.prototype,"name",void 0),m([Object(l["c"])("slug"),p("design:type",Object)],u.prototype,"slug",void 0),m([Object(l["b"])(),p("design:type","function"===typeof(o=!1)?o:Object)],u.prototype,"term",void 0),m([Object(l["b"])(),p("design:type",String)],u.prototype,"taxonomy",void 0),u=m([l["a"]],u);var f=u,y=f,h=n("2877"),b=n("27f9"),x=n("9c40"),v=n("eebe"),T=n.n(v),w=Object(h["a"])(y,s,r,!1,null,null,null),O=w.exports;T()(w,"components",{QInput:b["a"],QBtn:x["a"]});var q=n("2ef0"),j=n("3043"),_=n("761a"),P=n.n(_),D=function(e,t,n,o){var i,a=arguments.length,s=a<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(s=(a<3?i(s):a>3?i(t,n,s):i(t,n))||s);return a>3&&s&&Object.defineProperty(t,n,s),s},k=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};const C=Object(c["a"])("Taxonomy");let S=class extends l["d"]{constructor(){super(...arguments),this.term=this.getNewTerm(),this.pagination={sortBy:"name",descending:!0,page:1,rowsPerPage:10,rowsNumber:this.termsCountOfTaxonomy},this.columns=[{name:"name",required:!0,label:"Name",align:"left",field:"name",sortable:!0},{name:"slug",required:!0,label:"Slug",align:"left",field:"slug",sortable:!0},{name:"description",required:!0,label:"Description",align:"left",field:"description",sortable:!1}],this.filter="",this.selected=[],this.confirmDelete=!1,this.deleteLoading=!1}async created(){if(await this.fetch(),this.id){let e=this.termsOfTaxonomy.find((e=>e.id===parseInt(this.id)));e||(e=await this.fetchTermById({taxonomy:this.taxonomy,id:this.id})),e&&(this.term=Object(q["cloneDeep"])(e))}}async fetch(){await this.onRequest({pagination:this.pagination,filter:this.filter})}async onRequest(e){const{page:t,rowsPerPage:n,sortBy:o,descending:i}=e.pagination,a=0===n?"":n,s=(t-1)*n,r=this.filter;await this.fetchTermPage({taxonomy:this.taxonomy,startRow:s,fetchCount:a,filter:r,sortBy:o,descending:i}),this.pagination.page=t,this.pagination.rowsPerPage=n,this.pagination.sortBy=o,this.pagination.descending=i,this.pagination.rowsNumber=this.termsCountOfTaxonomy}getSelectedString(){return 0===this.selected.length?"":`${this.selected.length} ${this.selected.length>1?P()(this.taxonomy):this.taxonomy} selected of ${this.termsOfTaxonomy.length}`}getNewTerm(){return new class{}}reset(){this.term=this.getNewTerm()}onSave(e){this.term=Object(q["cloneDeep"])(e),this.fetch()}onDelete(){this.reset(),this.fetch()}async confirmDeleteAction(){this.deleteLoading=!0,await this.deleteTerms({taxonomy:this.taxonomy,terms:this.selected}),this.confirmDelete=!1,this.deleteLoading=!1,this.selected=[],await this.fetch()}editTerm(e){parseInt(this.id)!==e.id&&this.$router.push({name:"term_edit",params:{taxonomy:this.taxonomy,id:e.id.toString()}})}newTerm(){this.id&&(this.reset(),this.$router.push({name:"taxonomy_index",params:{taxonomy:this.taxonomy}}))}get termsOfTaxonomy(){return Object(q["get"])(this.terms,this.taxonomy,[])}get termsCountOfTaxonomy(){return Object(q["get"])(this.termsCount,this.taxonomy,0)}get isLoadingOfTaxonomy(){return Object(q["get"])(this.isLoading,this.taxonomy,!1)}get formattedTaxonomy(){return j["a"](this.pluralTaxonomy)}get pluralTaxonomy(){return P()(this.taxonomy)}get isNew(){var e;return!(null===(e=this.term)||void 0===e?void 0:e.id)}};D([C.State,k("design:type",Object)],S.prototype,"terms",void 0),D([C.State,k("design:type",Object)],S.prototype,"termsCount",void 0),D([C.State,k("design:type",Object)],S.prototype,"pagesCount",void 0),D([C.State,k("design:type",Object)],S.prototype,"isLoading",void 0),D([C.Action,k("design:type",Object)],S.prototype,"fetchTaxonomies",void 0),D([C.Action,k("design:type",Object)],S.prototype,"fetchTermById",void 0),D([C.Action,k("design:type",Object)],S.prototype,"fetchTermPage",void 0),D([C.Action,k("design:type",Object)],S.prototype,"deleteTerms",void 0),D([Object(l["b"])(),k("design:type",String)],S.prototype,"taxonomy",void 0),D([Object(l["b"])(),k("design:type",String)],S.prototype,"id",void 0),D([Object(l["e"])("filter"),k("design:type",Function),k("design:paramtypes",[]),k("design:returntype",Promise)],S.prototype,"fetch",null),S=D([Object(l["a"])({components:{TermForm:O}})],S);var R=S,N=R,Q=n("9989"),L=n("eaac"),$=n("db86"),A=n("3b16"),B=n("24e8"),E=n("f09f"),F=n("a370"),I=n("cb32"),z=n("4b7e"),J=n("de5e"),M=n("65c6"),Y=n("6ac5"),G=Object(h["a"])(N,i,a,!1,null,null,null);t["default"]=G.exports;T()(G,"components",{QPage:Q["a"],QTable:L["a"],QTd:$["a"],QBtn:x["a"],QPagination:A["a"],QDialog:B["a"],QCard:E["a"],QCardSection:F["a"],QAvatar:I["a"],QCardActions:z["a"],QPageSticky:J["a"],QToolbar:M["a"],QToolbarTitle:Y["a"]})}}]);